<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>Reset Password</title>
  <style media="screen">
    h4 {
      text-align: center;
    }
  </style>

  <link rel="stylesheet" href="/app.css">
</head>

<body>
  <nav id="Header" class="navbar navbar-default">
    <div class="navbar-header">
      <a class="navbar-brand" href="#">
        <i class="fa fa-compass" aria-hidden="true"></i>TrailMaster
      </a>
    </div>
  </nav>
  <div class="container">
    <div class="row">
      <h4>Reset Password</h4>
    </div>
    <div class="row">
      <div class="col-xs-4 col-xs-push-4">
        <form id="password-form" action="index.html" method="post">
          <input class="form-control" type="password" id="newpass1" placeholder="New Password" />
          <input class="form-control" type="password" id="newpass2" placeholder="Confirm New Password" />
          <input class="btn btn-info form-control" style="float: right" type="submit" name="" value="Submit" />
        </form>
      </div>
    </div>
  </div>
  <script type="text/javascript">
    document.getElementById('password-form').addEventListener('submit', verify);

    function verify(e) {
      e.preventDefault();
      var passOne = document
        .getElementById('newpass1')
        .value;
      var passTwo = document
        .getElementById('newpass2')
        .value;
      if (passOne !== passTwo) {
        throw new Error('Passwords do not match');
      }
      var xmlHTTP = new XMLHttpRequest();
      xmlHTTP.open('PATCH', '/users/password', true);
      var id = window
        .location
        .pathname
        .split('/')
        .reverse()[0];
      xmlHTTP.setRequestHeader('Content-type', 'application/json');
      xmlHTTP.send(JSON.stringify({
        id: id,
        password: passOne
      }));
      xmlHTTP.onload = function() {
        console.log(xmlHTTP);
        if(xmlHTTP.status === 200) window.location.href = window.location.protocol + '//' + window.location.host;
      };

    }
  </script>
</body>

</html>
